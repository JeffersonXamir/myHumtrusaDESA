

var inicioLogin = function (){
	/*
	new Ext.Viewport({
	    layout: 'border',
	    items: [{
	        region: 'center',
	        html: '<h1 class="x-panel-header">Page Title</h1>',
	        tpl: '<img src="vistas/Login/logo.jpg" />',
	        autoHeight: true,
	        border: false,
	        margins: '0 0 5 0'
	    }]
	});
	*/
	var generales = {
	
		url: "servlet/SAdministracionGeneral"
	
	};
	
	var botones = {
		cmdCancelar: new Ext.Button({text:"Cancelar",icon:"imagenes/cancel.png",cls:"x-btn-text-icon"}),
		cmdIngreso: new Ext.Button({text:"Ingresar",icon:"imagenes/bullet_go.png",cls:"x-btn-text-icon"})
	}
	var fieldSetsForma = { 
			flsDatosValidacion: new Ext.form.FieldSet({
				border:false,
				//title:"-PASO 1- Cantidad de Bonificados",
				items: [      
					{ xtype: 'box', 
					autoEl: { 
								tag: 'div',
							  	html: '<div class="app-msg"> <img src="imagenes/usuarioLogin.png" class="app-img" /> </br><center><b>INGRESO AL SISTEMA </b> </center> </div>'
							}
					}
				],
				//autoHeight: true
				height:200 
			}),
		
			flsDatosClasificacion: new Ext.form.FieldSet({
				title:"Inicio de Sesi&oacute;n",
				autoHeight: true,
				buttonAlign : "center",
				//height:210,
				//width:350
				items:[
					{ 
						xtype: 'textfield', 
						id: 'login-user',
						fieldLabel: 'Usuario', 
						allowBlank: false, minLength: 3, maxLength: 32,  
						msgTarget:'side'
					},  
					{ 
						xtype: 'textfield', id: 'login-pwd',  
						fieldLabel: 'Contraseña',    
						inputType: 'password', allowBlank: false, minLength: 6,
						maxLength: 32, minLengthText: 'Password must be at least 6 characters long.', 
						msgTarget:'side'  
					} 
				],
				buttons:[
					botones.cmdIngreso,
					botones.cmdCancelar
				]
			})
		};
	
	
	
	var panelSecundario = new Ext.Panel({
				layout : "column",
				region : "center",
				collapsible : true,
				//bodyStyle: 'padding:15px;background:transparent', 
				//autoHeight: true,
				height : 230, 
				border : false,
				items : [
						new Ext.Panel({
							border:false,
							bodyStyle:"padding:5px",
							layout:"form",
							columnWidth:0.4,
							height : 300,
							items:[fieldSetsForma.flsDatosValidacion]
						}),
						new Ext.Panel({
							border:false,  
							bodyStyle:"padding:40px 10px 0 10px",   
							layout:"form",
							columnWidth:0.6,    
							height : 300, 
							items:[fieldSetsForma.flsDatosClasificacion] 
						})				
				]
	});
			
	var panelPrincipal = new Ext.form.FormPanel({
		// region:"center",
		layout : "border",
		labelWidth : 70,
		style : "padding:0px",
		monitorValid : true,
		buttonAlign : "center",
		region : "center",
		items : [panelSecundario]
	});
	
	var vntLogin = new Ext.Window({
		xtype : "window",
		title : "Login",
		width : 500,
		height : 250,  
		//resizable : true,
		//modal : true,
		closable : false,
		//closeAction : "hide", 
		layout : "border", 
		items : [panelPrincipal]
			// ,
			// bbar: controladorBloqueos.crearBarraBloqueos()
		});
	//vntLogin.show();
	vntLogin.setVisible(true);
	vntLogin.center();


	botones.cmdIngreso.on("click",function(){
		var usuario = Ext.getCmp("login-user").getValue();
		var contra = Ext.getCmp("login-pwd").getValue();
		var obj =null;
		
		if( usuario == "" ){
			Ext.MessageBox.show({title:"Atenci\xf3n", 
								msg: "Ingrese un Usuario", 
								buttons:Ext.MessageBox.OK, 
								icon:Ext.MessageBox.WARNING});
			return;
		}
		if( contra == "" ){
			Ext.MessageBox.show({title:"Atenci\xf3n", 
								msg: "Ingrese una Contraseña", 
								buttons:Ext.MessageBox.OK, 
								icon:Ext.MessageBox.WARNING});
			return;
		}
		var paramsDat = {			
						url: generales.url,
						params:{
							orden: "LOGIN",
							user: usuario,
							pass: contra
							
						},
						success: function(A,B){
							if (A.responseText) {
								obj = Ext.util.JSON.decode(A.responseText);
							} else {
								if (B.result) {
								obj = B.result;
								}
							}
							if(obj.get("exito")== false){
								Ext.MessageBox.show({title:"Atenci\xf3n", 
													msg: obj.get("mensaje"), 
													buttons:Ext.MessageBox.OK, 
													icon:Ext.MessageBox.WARNING}
													);
								}
							
						}
				}
		Ext.Ajax.request(paramsDat);
		
	});


}

Ext.onReady(function() {
	document.pantallainicial = new inicioLogin();
});

